<!DOCTYPE html>
<html>
<head>
    <title>Test OSRM Routing</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body { margin: 0; padding: 0; }
        #map { height: 100vh; width: 100%; }
        #info {
            position: absolute;
            top: 10px;
            right: 10px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 1000;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <div id="info">
        <h3>OSRM Routing Test</h3>
        <p>Testing road-to-road navigation</p>
        <div id="route-info"></div>
    </div>
    <div id="map"></div>

    <script>
        // Initialize map
        const map = L.map('map').setView([28.6139, 77.2090], 6);
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors'
        }).addTo(map);

        // Test route: Delhi to Mumbai
        const start = { lat: 28.6139, lng: 77.2090 }; // Delhi
        const end = { lat: 19.0760, lng: 72.8777 };   // Mumbai

        // Add markers
        L.marker([start.lat, start.lng]).addTo(map)
            .bindPopup('Delhi (Start)').openPopup();
        L.marker([end.lat, end.lng]).addTo(map)
            .bindPopup('Mumbai (End)');

        // Fetch route from OSRM
        async function getRoute() {
            const url = `https://router.project-osrm.org/route/v1/driving/${start.lng},${start.lat};${end.lng},${end.lat}?overview=full&geometries=geojson`;
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.code === 'Ok' && data.routes && data.routes.length > 0) {
                    const route = data.routes[0];
                    
                    // Convert coordinates to Leaflet format
                    const coordinates = route.geometry.coordinates.map(coord => [coord[1], coord[0]]);
                    
                    // Draw route on map
                    L.polyline(coordinates, {
                        color: '#3B82F6',
                        weight: 5,
                        opacity: 0.7
                    }).addTo(map);
                    
                    // Fit map to route
                    map.fitBounds(coordinates);
                    
                    // Show route info
                    const distanceKm = (route.distance / 1000).toFixed(2);
                    const durationHrs = (route.duration / 3600).toFixed(1);
                    
                    document.getElementById('route-info').innerHTML = `
                        <p><strong>Distance:</strong> ${distanceKm} km</p>
                        <p><strong>Duration:</strong> ${durationHrs} hours</p>
                        <p><strong>Status:</strong> ✅ Real road routing working!</p>
                    `;
                } else {
                    document.getElementById('route-info').innerHTML = `
                        <p style="color: red;">❌ Routing failed</p>
                    `;
                }
            } catch (error) {
                console.error('Routing error:', error);
                document.getElementById('route-info').innerHTML = `
                    <p style="color: red;">❌ Error: ${error.message}</p>
                `;
            }
        }

        // Fetch route on load
        getRoute();
    </script>
</body>
</html>
